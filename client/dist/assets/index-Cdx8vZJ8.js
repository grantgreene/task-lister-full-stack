(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerPolicy&&(a.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?a.credentials="include":t.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(t){if(t.ep)return;t.ep=!0;const a=s(t);fetch(t.href,a)}})();class l{constructor(){this.Api="/tasks"}async getTasks(){return await(await fetch(this.Api)).json()}async addTask(e){await fetch(this.Api,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}async editTask(e,s){await fetch(`${this.Api}/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})}async deleteTask(e){await fetch(`${this.Api}/${e}`,{method:"DELETE"})}}const o=new l;class r{static buildTaskHtml(e){const s=document.createElement("div");s.classList="task-card";for(const n in e)if(n==="_id")s.dataset.id=e[n];else if(n==="date"){const t=document.createElement("p");t.classList="task-card__date";const a=new Date(e[n]).toLocaleDateString("en-Us",{timeZone:"UTC"});t.textContent=`${a}`,new Date(a)<new Date&&t.classList.add("past-due"),s.appendChild(t)}else if(n==="delete"){const t=document.createElement("span");t.classList="task-card__delete";const a=document.createElement("i");a.classList="fa-solid fa-trash-can",t.appendChild(a),s.appendChild(t)}else if(n==="name"){const t=document.createElement("h1");t.classList="task-card__name",t.textContent=`${e[n]}`,s.appendChild(t)}else if(n==="status"){const t=document.createElement("p");t.classList="task-card__status";const a=document.createElement("span");a.textContent="Status: ";const i=document.createTextNode(`${e[n]} `),c=document.createElement("i");c.classList="fa-solid fa-caret-down",t.appendChild(a),t.appendChild(i),t.appendChild(c),s.appendChild(t)}return s}static addTasksToUi(e){let s;document.querySelector(".tasks").innerHTML="",(async()=>(e?s=e:s=await(await o.getTasks()).data,s.length===0?document.querySelector(".no-tasks").classList.add("show"):(document.querySelector(".no-tasks").classList.remove("show"),s.forEach(n=>{const t=this.buildTaskHtml(n);document.querySelector(".tasks").appendChild(t)})),document.querySelector(".filter-category").value="show all"))()}}class u{constructor(){this.addNewMobileBtn=document.querySelector(".top-pane__btn"),this.addTaskPane=document.querySelector(".add-task-pane"),this.addNewTaskBtn=document.querySelector(".add-task-pane__btn"),this.addTaskNameInput=document.querySelector(".add-task-pane__name-input"),this.addTaskDateInput=document.querySelector(".add-task-pane__date-input"),this.alertNotification=document.querySelector(".alert"),this.addEventListeners()}toggleMobileDropdown(){this.addTaskPane.classList.toggle("open"),this.addTaskPane.classList.contains("open")?(this.addNewMobileBtn.textContent="x")&&(this.addNewMobileBtn.style.backgroundColor="var(--c-red)"):(this.addNewMobileBtn.textContent="+")&&(this.addNewMobileBtn.style.backgroundColor="var(--c-green")}showAlert(e){this.alertNotification.classList.add("show"),this.alertNotification.children[0].textContent=`${e}`,setTimeout(()=>{this.alertNotification.classList.remove("show")},3e3)}addNewTask(){let e=this.addTaskNameInput.value,s=this.addTaskDateInput.value;if(e===""&&s===""){this.showAlert("Please enter a task name and task date");return}else if(e===""){this.showAlert("Please enter a task name");return}else if(s===""){this.showAlert("Please enter a task date");return}(async()=>{let t=(await o.getTasks()).data;const a={date:s,name:e,status:"To-Do",delete:!1};t.push(a),await o.addTask(a),r.addTasksToUi(),this.addTaskNameInput.value="",this.addTaskDateInput.value="",this.toggleMobileDropdown()})()}addEventListeners(){this.addNewMobileBtn.addEventListener("click",this.toggleMobileDropdown.bind(this)),this.addNewTaskBtn.addEventListener("click",this.addNewTask.bind(this))}}class h{constructor(){this.searchTasksInput=document.querySelector(".search-tasks-input"),this.dateSortBtn=document.querySelectorAll(".date-sort"),this.filterCategorySelect=document.querySelector(".filter-category"),this.eventListeners()}searchTasks(e){let s=this.searchTasksInput.value.toLowerCase();this.filterCategorySelect.value="show all",document.querySelectorAll(".task-card").forEach(t=>{t.children[1].textContent.toLowerCase().indexOf(s)===-1&&t.children[0].textContent.toLowerCase().indexOf(s)===-1?t.style.display="none":t.style.display="block"})}sortByDate(e){(async()=>{const n=await(await o.getTasks()).data;e.target.classList.contains("date-asc")?n.sort((t,a)=>t.date.localeCompare(a.date)):n.sort((t,a)=>a.date.localeCompare(t.date)),r.addTasksToUi(n)})()}filterCategories(e){const s=e.target.value;document.querySelectorAll(".task-card").forEach(t=>{s==="show all"||t.children[2].textContent.replace("Status: ","").trim().toLowerCase()===s?t.style.display="block":t.style.display="none"})}eventListeners(){this.searchTasksInput.addEventListener("keyup",this.searchTasks.bind(this)),this.dateSortBtn.forEach(e=>{e.addEventListener("click",this.sortByDate.bind(this))}),this.filterCategorySelect.addEventListener("change",this.filterCategories.bind(this))}}class p{constructor(){this.taskBoard=document.querySelector(".tasks"),this.editTaskId,this.eventListeners()}deleteTask(e){if(e.target.classList.contains("fa-trash-can")){const s=e.target.parentElement.parentElement.dataset.id;(async()=>(await o.deleteTask(s),r.addTasksToUi()))()}}getTaskId(e){e.target.classList.contains("task-card__status")&&(this.editTaskId=e.target.parentElement.dataset.id,document.dispatchEvent(new Event("openOverlayEvent")))}editTaskStatus(e){let s=e.target.textContent;(async()=>{const a=(await(await o.getTasks()).data).filter(i=>i._id===this.editTaskId)[0];a.status=s,await o.editTask(this.editTaskId,a),r.addTasksToUi()})(),document.dispatchEvent(new Event("closeOverlayEvent"))}eventListeners(){this.taskBoard.addEventListener("click",this.deleteTask.bind(this)),this.taskBoard.addEventListener("click",this.getTaskId.bind(this)),document.querySelectorAll(".update-status-box__option").forEach(e=>{e.addEventListener("click",this.editTaskStatus.bind(this))})}}class k{constructor(){this.updateStatusOverlay=document.querySelector(".update-status-overlay"),this.eventListeners()}openOverlay(){this.updateStatusOverlay.classList.add("open")}closeOverlay(){this.updateStatusOverlay.classList.remove("open")}eventListeners(){document.addEventListener("openOverlayEvent",this.openOverlay.bind(this)),document.addEventListener("closeOverlayEvent",this.closeOverlay.bind(this)),document.addEventListener("click",e=>{e.target.classList.contains("update-status-box__close")&&this.closeOverlay()})}}r.addTasksToUi();new u;new h;new p;new k;
